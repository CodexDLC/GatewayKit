# Переменные окружения и конфигурация

## 1. Общий принцип (ENV-policy)

Все конфигурационные параметры передаются в сервисы через переменные окружения.

-   **В репозитории** хранится только файл `.env.sample` с примерами переменных без реальных секретов.
-   **Для локальной разработки** создается файл `.env` на основе `.env.sample`. Этот файл находится в `.gitignore` и не должен попадать в репозиторий.
-   **В production-среде** переменные поставляются исключительно оркестратором (Docker Compose, Kubernetes). Использование `dotenv` в рантайме **запрещено**.

## 2. Общие переменные

Эти переменные используются большинством сервисов.

| Переменная          | Описание                                           | Пример                                             | Обязательность |
| :------------------ | :------------------------------------------------- | :------------------------------------------------- | :------------- |
| `CONTAINER_ID`      | Уникальное имя сервиса. Используется для логирования. | `auth_svc`                                         | **Да** |
| `LOG_LEVEL`         | Уровень логирования.                               | `INFO`                                             | Нет (по умолч. `INFO`) |
| `RABBITMQ_DSN`      | DSN для подключения к RabbitMQ.                    | `amqp://user:pass@rabbitmq:5672/`                  | **Да** |
| `DATABASE_URL`      | DSN для подключения к PostgreSQL.                  | `postgresql+asyncpg://user:pass@postgres:5432/game` | Для сервисов с БД |
| `REDIS_URL`         | URL для подключения к Redis.                       | `redis://redis:6379/0`                             | Для сервисов с Redis |
| `REDIS_PASSWORD`    | Пароль для Redis.                                  | `your_secure_password`                             | Для сервисов с Redis |

## 3. Переменные `auth_svc`

| Переменная   | Описание                                 | Пример                            | Обязательность |
| :----------- | :--------------------------------------- | :-------------------------------- | :------------- |
| `JWT_SECRET` | Секретный ключ для подписи JWT.          | `a_very_long_and_secure_secret`   | **Да** |
| `JWT_ALG`    | Алгоритм подписи JWT.                    | `HS256`                           | Нет (по умолч. `HS256`) |
| `DB_SCHEMA`  | Схема в PostgreSQL для работы сервиса.   | `auth`                            | **Да** |

## 4. Переменные `gateway`

| Переменная            | Описание                                  | Пример | Обязательность |
| :-------------------- | :---------------------------------------- | :----- | :------------- |
| `WS_HEARTBEAT_SEC`    | Интервал heartbeat для WebSocket (в секундах). | `30`   | Нет (по умолч. `30`) |
| `WS_AUTH_TIMEOUT_SEC` | Таймаут на авторизацию по WebSocket.      | `5`    | Нет (по умолч. `5`) |